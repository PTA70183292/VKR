import streamlit as st                                      # –ò–º–ø–æ—Ä—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.
import requests                                             # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API.
import pandas as pd                                         # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–∞–±–ª–∏—á–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
import time                                                 # –ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º 
import os                                                   # –ú–æ–¥—É–ª—å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –û–°.

st.set_page_config(                                         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∑–∞–≥–æ–ª–æ–≤–æ–∫, –∏–∫–æ–Ω–∫–∞, –º–∞–∫–µ—Ç).
    page_title="–¶–µ–Ω—Ç—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ú–£–ò–í",                      # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—Å—Ç–∞, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞.
    layout="centered",                                      # –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è.
    page_icon="üéì"                                          # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–∞–≤–∏–∫–æ–Ω–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
)

API_URL = os.getenv("BACKEND_URL", "http://backend:8000")   # –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–¥—Ä–µ—Å–∞ API –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.

# –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Å—Å–∏–∏
if "student_token" not in st.session_state:                 # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–µ—Å—Å–∏–∏.
    st.session_state.student_token = None                   # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–æ–∫–µ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ–º None.
if "student_user" not in st.session_state:                  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–µ—Å—Å–∏–∏.
    st.session_state.student_user = None                    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

# –°—á–µ—Ç—á–∏–∫ –¥–ª—è —Å–±—Ä–æ—Å–∞ —Ñ–æ—Ä–º—ã
if "form_counter" not in st.session_state:                  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—á–µ—Ç—á–∏–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ñ–æ—Ä–º.
    st.session_state.form_counter = 0                       # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ —Å–±—Ä–æ—Å–∞.

# –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
def get_headers():                                          # –§—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤.
    if st.session_state.student_token:                      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
        return {"Authorization": f"Bearer {st.session_state.student_token}"} # –í–æ–∑–≤—Ä–∞—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å JWT-—Ç–æ–∫–µ–Ω–æ–º —Ç–∏–ø–∞ Bearer.
    return {}                                               # –í–æ–∑–≤—Ä–∞—Ç –ø—É—Å—Ç–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

def login_student(username, password):                      # –§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞.
    try:                                                    # –ù–∞—á–∞–ª–æ –±–ª–æ–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Å–µ—Ç–µ–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
        resp = requests.post(                               # –û—Ç–ø—Ä–∞–≤–∫–∞ POST-–∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞.
            f"{API_URL}/token",                             # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ URL –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
            data={"username": username, "password": password}, # –ü–µ—Ä–µ–¥–∞—á–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ (x-www-form-urlencoded).
            timeout=5                                       # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–∞—É—Ç–∞ –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞.
        )
        if resp.status_code == 200:                         # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç–≤–µ—Ç–∞ (OK).
            data = resp.json()                              # –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON-–æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞.
            if data.get("role") != "student":               # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤).
                 st.error("–≠—Ç–æ—Ç –ø–æ—Ä—Ç–∞–ª —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤.") # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ –¥–æ—Å—Ç—É–ø–∞.
                 return                                     # –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏.

            st.session_state.student_token = data["access_token"] # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ JWT-—Ç–æ–∫–µ–Ω–∞ –≤ —Å–µ—Å—Å–∏—é.
            st.session_state.student_user = data["username"] # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–µ—Å—Å–∏—é.
            st.rerun()                                      # –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.
        else:                                               # –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—É—Å–ø–µ—à–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ç–≤–µ—Ç–∞.
            st.error("–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å")           # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–µ–≤–µ—Ä–Ω—ã—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
    except Exception as e:                                  # –ü–µ—Ä–µ—Ö–≤–∞—Ç –ª—é–±—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞.
        st.error(f"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: {e}")                # –í—ã–≤–æ–¥ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—à–∏–±–∫–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

def create_ticket(subject, description):                    # –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –≤ —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É.
    payload = {                                             # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–∏–∫–µ—Ç–∞.
        "subject": subject,                                 # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º—ã –æ–±—Ä–∞—â–µ–Ω–∏—è.
        "description": description,                         # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã.
        "user_email": "ignored"                             # –ü–æ–ª–µ email (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è –±—ç–∫–µ–Ω–¥–æ–º, —Ç–∞–∫ –∫–∞–∫ –±–µ—Ä–µ—Ç—Å—è –∏–∑ —Ç–æ–∫–µ–Ω–∞).
    }
    
    try:                                                    # –ù–∞—á–∞–ª–æ –±–ª–æ–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
        response = requests.post(                           # –û—Ç–ø—Ä–∞–≤–∫–∞ POST-–∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞.
            f"{API_URL}/tickets",                           # URL —Ä–µ—Å—É—Ä—Å–∞ —Ç–∏–∫–µ—Ç–æ–≤.
            json=payload,                                   # –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.
            headers=get_headers(),                          # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
            timeout=10                                      # –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.
        )
        
        if response.status_code == 200:                     # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–∞.
            return True, "–û–±—Ä–∞—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ"             # –í–æ–∑–≤—Ä–∞—Ç –∫–æ—Ä—Ç–µ–∂–∞ —Å —Ñ–ª–∞–≥–æ–º —É—Å–ø–µ—Ö–∞ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ–º.
        else:                                               # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã —Å–µ—Ä–≤–µ—Ä–∞.
            return False, f"–û—à–∏–±–∫–∞: {response.text}"        # –í–æ–∑–≤—Ä–∞—Ç —Ñ–ª–∞–≥–∞ –Ω–µ—É–¥–∞—á–∏ –∏ —Ç–µ–∫—Å—Ç–∞ –æ—à–∏–±–∫–∏ –æ—Ç API.
            
    except Exception as e:                                  # –ü–µ—Ä–µ—Ö–≤–∞—Ç –æ—à–∏–±–æ–∫ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.
        return False, f"–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: {str(e)}"        # –í–æ–∑–≤—Ä–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –∏—Å–∫–ª—é—á–µ–Ω–∏–∏.

def get_my_tickets():                                       # –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    try:                                                    # –ë–ª–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π.
        response = requests.get(                            # –û—Ç–ø—Ä–∞–≤–∫–∞ GET-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
            f"{API_URL}/tickets",                           # URL —Ä–µ—Å—É—Ä—Å–∞ —Ç–∏–∫–µ—Ç–æ–≤.
            headers=get_headers(),                          # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
            timeout=5                                       # –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞.
        )
        if response.status_code == 200:                     # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞.
            return response.json()                          # –í–æ–∑–≤—Ä–∞—Ç —Å–ø–∏—Å–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Python-–æ–±—ä–µ–∫—Ç–æ–≤.
        return []                                           # –í–æ–∑–≤—Ä–∞—Ç –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–µ—Ä–≤–µ—Ä–∞.
    except:                                                 # –ü–µ—Ä–µ—Ö–≤–∞—Ç –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π (silent fail).
        return []                                           # –í–æ–∑–≤—Ä–∞—Ç –ø—É—Å—Ç–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

# –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
if not st.session_state.student_token:                      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Ö–æ–¥–∞.
    st.markdown("<br><br>", unsafe_allow_html=True)         # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –æ—Ç—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ HTML.
    st.title("–¶–µ–Ω—Ç—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏")                             # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
    
    with st.form("login"):                                  # –°–æ–∑–¥–∞–Ω–∏–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö.
        u = st.text_input("–ü–æ—á—Ç–∞")                          # –ü–æ–ª–µ –≤–≤–æ–¥–∞ –ª–æ–≥–∏–Ω–∞/–ø–æ—á—Ç—ã.
        p = st.text_input("–ü–∞—Ä–æ–ª—å", type="password")        # –ü–æ–ª–µ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è —Å–æ —Å–∫—Ä—ã—Ç–∏–µ–º —Å–∏–º–≤–æ–ª–æ–≤.
        if st.form_submit_button("–í–æ–π—Ç–∏", type="primary"):  # –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã (primary —Å—Ç–∏–ª—å).
            if not u or not p:                              # –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª–µ–π.
                st.warning("–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ")                # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.
            else:                                           # –ï—Å–ª–∏ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã:
                login_student(u, p)                         # –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
                
    st.info("–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö –í–ö–†. –°—Ç—É–¥–µ–Ω—Ç (–æ.–ò–ó–î—Ç 23.2/–ë3-21) (70183292)")
    st.stop()                                               # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞, —á—Ç–æ–±—ã –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.

# –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
with st.sidebar:                                            # –ë–ª–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏.
    st.write(f"–°—Ç—É–¥–µ–Ω—Ç: **{st.session_state.student_user}**")# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    if st.button("–í—ã–π—Ç–∏"):                                  # –ö–Ω–æ–ø–∫–∞ –¥–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
        st.session_state.student_token = None               # –°–±—Ä–æ—Å —Ç–æ–∫–µ–Ω–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–µ—Å—Å–∏–∏.
        st.rerun()                                          # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ —ç–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞.

st.title("–¶–µ–Ω—Ç—Ä –ø–æ–¥–¥–µ—Ä–∂–∫–∏")                                 # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

tab1, tab2 = st.tabs(["–ù–æ–≤–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ", "–ú–æ–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è"])  # –°–æ–∑–¥–∞–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏.

with tab1:                                                  # –ö–æ–Ω—Ç–µ–Ω—Ç –ø–µ—Ä–≤–æ–π –≤–∫–ª–∞–¥–∫–∏ (–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞).

    with st.form("new_ticket"):                             # –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è.

        current_key = st.session_state.form_counter         # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–∞ –¥–ª—è —É–Ω–∏–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª—é—á–µ–π –≤–∏–¥–∂–µ—Ç–æ–≤.
        
        subj = st.text_input("–¢–µ–º–∞", key=f"subj_{current_key}") # –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Ç–µ–º—ã —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∫–ª—é—á–æ–º.
        desc = st.text_area("–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ", key=f"desc_{current_key}") # –¢–µ–∫—Å—Ç–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∫–ª—é—á–æ–º.
        
        if st.form_submit_button("–û—Ç–ø—Ä–∞–≤–∏—Ç—å", type="primary"): # –ö–Ω–æ–ø–∫–∞ —Å–∞–±–º–∏—Ç–∞ —Ñ–æ—Ä–º—ã.
            if not subj or not desc:                        # –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø—É—Å—Ç—ã–µ –ø–æ–ª—è.
                st.warning("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è")            # –í—ã–≤–æ–¥ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.
            else:                                           # –ï—Å–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–∞:
                ok, msg = create_ticket(subj, desc)         # –í—ã–∑–æ–≤ API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∏–∫–µ—Ç–∞.
                if ok:                                      # –ï—Å–ª–∏ —Ç–∏–∫–µ—Ç —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ:
                    st.success(msg)                         # –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ.
                    time.sleep(2)                           # –ü–∞—É–∑–∞ –¥–ª—è –ø—Ä–æ—á—Ç–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
                    
                    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ - –∫–ª—é—á–∏ –ø–æ–ª–µ–π –∏–∑–º–µ–Ω—è—Ç—Å—è - –ø–æ–ª—è –æ—á–∏—Å—Ç—è—Ç—Å—è
                    st.session_state.form_counter += 1      # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç —Å—á–µ—Ç—á–∏–∫–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ–Ω–¥–µ—Ä–µ.
                    st.rerun()                              # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
                else:                                       # –ï—Å–ª–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞:
                    st.error(msg)                           # –í—ã–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ –æ—à–∏–±–∫–∏.

with tab2:                                                  # –ö–æ–Ω—Ç–µ–Ω—Ç –≤—Ç–æ—Ä–æ–π –≤–∫–ª–∞–¥–∫–∏ (–°–ø–∏—Å–æ–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π).
    tickets = get_my_tickets()                              # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞.
    if tickets:                                             # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö.
        df = pd.DataFrame(tickets)                          # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–ª–æ–≤–∞—Ä–µ–π –≤ DataFrame.
        if "created_at" in df.columns:                      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–ª–æ–Ω–∫–∏ –¥–∞—Ç—ã.
            df["created_at"] = pd.to_datetime(df["created_at"]).dt.strftime('%d.%m.%Y %H:%M') # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏ –≤ —á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥.
            
        st.dataframe(                                       # –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã.
            df[["id", "created_at", "subject", "status"]].rename(columns={ # –í—ã–±–æ—Ä –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.
                "id": "‚Ññ", "created_at": "–î–∞—Ç–∞", "subject": "–¢–µ–º–∞", "status": "–°—Ç–∞—Ç—É—Å"
            }),
            use_container_width=True,                       # –†–∞—Å—Ç—è–≥–∏–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –≤—Å—é —à–∏—Ä–∏–Ω—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
            hide_index=True                                 # –°–∫—Ä—ã—Ç–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ DataFrame.
        )
    else:                                                   # –ï—Å–ª–∏ —Ç–∏–∫–µ—Ç–æ–≤ –Ω–µ—Ç:
        st.info("–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–π.")                # –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.